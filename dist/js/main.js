document.addEventListener("DOMContentLoaded",()=>{controlNavbarVisibility();const e=document.querySelector(".btn-arrow");controlFloatingBtnVisibility(e),scrollToTop(e);const t=document.querySelector(".sidenav");M.Sidenav.init(t,{});const n=document.querySelectorAll(".scrollspy");M.ScrollSpy.init(n,{scrollOffset:0});const o=document.querySelector(".modal"),d=M.Modal.init(o,{endingTop:"0%",inDuration:50,outDuration:50});document.querySelectorAll(".gallery-item").forEach(e=>{e.addEventListener("click",()=>{openGalleryModal(e,d)})})});const controlNavbarVisibility=()=>{const e=document.querySelector(".navbar-custom");let t=window.pageYOffset;window.addEventListener("scroll",()=>{let n=window.pageYOffset;e.style.top=t<n&&n>208?"-104px":"0",t=n})},controlFloatingBtnVisibility=e=>{window.addEventListener("scroll",()=>{window.pageYOffset>208?e.classList.remove("hidden"):e.classList.add("hidden")})},scrollToTop=e=>{e.addEventListener("click",()=>{window.chrome?scrollIntoViewInChrome():document.querySelector("#home").scrollIntoView({behavior:"smooth",block:"start"})})},openGalleryModal=async(e,t)=>{const n=e.childNodes[0].classList.value,o=n.substr(n.length-1);t.open();const d=(await axios.get(`/projects/${o}`)).data,l=document.querySelector(".modal"),a=await createModalContent(d),c=createModalFooter(t,l);l.innerHTML=null,l.appendChild(a),l.appendChild(c);const s=document.querySelectorAll(".materialboxed");M.Materialbox.init(s,{onOpenEnd:()=>document.body.style.overflow="hidden",onCloseEnd:()=>document.body.style.overflow="hidden"})},createModalContent=async e=>{const t=document.createElement("div");t.classList.add("modal-content");const n=document.createElement("div");n.classList.add("img-gallery"),await Promise.all(e.urls.map(async e=>createImage(e,n)));const o=createTextContent(e);return t.appendChild(n),t.appendChild(o),t},createImage=async(e,t)=>{const n=document.createElement("div");n.classList.add("img-container");const o=document.createElement("img");return o.classList.add("materialboxed"),o.src=e,await imageIsLoaded(o),n.appendChild(o),t.appendChild(n),Promise.resolve(e)},imageIsLoaded=e=>new Promise((t,n)=>e.addEventListener("load",()=>t())),createTextContent=e=>{const t=["Категория","Фаза","Местоположение"],n=document.createElement("div");n.classList.add("text-content");const o=document.createElement("h4");o.classList.add("grey","lighten-2","grey-text","text-darken-2"),o.innerText=e.text;const d=document.createElement("ul");return[e.category,e.state,e.location].forEach((e,n)=>{const o=document.createElement("li");d.classList.add("grey-text","text-darken-4");const l=document.createElement("span");l.classList.add("grey-text"),l.innerText=`${t[n]}: `,o.appendChild(l),o.insertAdjacentText("beforeend",e),d.appendChild(o)}),n.appendChild(o),n.appendChild(d),n},createModalFooter=(e,t)=>{const n=document.createElement("div");n.classList.add("modal-footer");const o=document.createElement("div");o.classList.add("btn-container");const d=document.createElement("button");return d.classList.add("btn","waves-effect","waves-light","red","custom-cancel-btn"),d.innerText="Изход от галерията",d.addEventListener("click",()=>closeModal(e,t)),o.appendChild(d),n.appendChild(o),n},closeModal=(e,t)=>{e.close();const n=document.createElement("div");n.classList.add("preloader-wrapper","small","active");const o=document.createElement("div");o.classList.add("spinner-layer");const d=document.createElement("div");d.classList.add("circle-clipper","left");const l=document.createElement("div");l.classList.add("gap-patch");const a=document.createElement("div");a.classList.add("circle-clipper","right");const c=document.createElement("div");c.classList.add("circle"),d.appendChild(c),l.appendChild(c),a.appendChild(c),o.appendChild(d),o.appendChild(l),o.appendChild(a),n.appendChild(o),t.innerHTML=null,t.appendChild(n)},scrollIntoViewInChrome=()=>{smoothScroll()},smoothScroll=()=>{let e=window.scrollY/8;setTimeout(function(){window.scroll(0,window.scrollY-e),0!==window.scrollY&&smoothScroll()},10)};